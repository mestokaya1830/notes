<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        scroll-behavior: smooth;
      }
      body{
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      h1{
        margin: 30px 0;
      }
      .wrapper{
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 60vw;
        background-color: #000;
        padding: 30px 80px;
        border-radius: 30px;
        position: relative;
        overflow: hidden;
      }
      #container {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        border-radius: 5px;
        margin: 50px auto;
        object-fit: cover;
        padding: 10px 5px;
        box-shadow: inset 0 0 50px #f8a100;
      }
      #img {
        width: 100%;
        height: 100%;
        aspect-ratio: 16/9;
      }
      .prev,
      .next {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
        cursor: pointer;
        color: #000;
        font-weight: bold;
        font-size: 30px;
        transition: 0.6s ease;
        user-select: none;
        background-color: #f1f1f1;
      }
      .prev{
        margin-right: 14px;
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
      }
      .next{
        margin-left: 14px;
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
      }
      .prev:hover,
      .next:hover {
        transform: scale(1.2);
      }
      .hide{
        background-color: gray;
        cursor: not-allowed;
      }

      .sub-slide{
        display: flex;
        width: 100%;
        height: 120px;
        position: absolute;
        bottom: 0;
        overflow: hidden;
      }
      .sub-slide.active {
        cursor: grab;
        scroll-behavior: auto;
      }
      .sub-slide::-webkit-scrollbar {
          display: none;
        }
      .sub-container{
        flex: 1;
        min-width: calc(100% / 4);
        height: 100%;
        cursor: pointer;
        border: 2px solid transparent;
        /* user-select: none; */
      }
      .sub-img{
        width: 100%;
        height: 100%;
        /* user-select: none; */
      }
      .sub-style{
        border: 2px solid #f8a100;
      }
    </style>
  </head>
  <body>
    <h1>Javascript Blink Slider</h1>
    <div class="wrapper">
      <div id="container">
        <button class="prev" id="prev">❮</button>
        <img src="" alt="" id="img"/>
        <button class="next" id="next">❯</button>
      </div>
      <div class="sub-slide">
        
      </div>
    </div>

    <script>
      let images = [
        "../images/img1.jpg",
        "../images/img2.jpg",
        "../images/img3.jpg",
        "../images/img4.jpg",
        "../images/1.jpg",
        "../images/2.jpg",
        "../images/3.jpg",
        "../images/4.jpg",
      ];

      

      //load sub images
      images.forEach(item => {
        document.querySelector('.sub-slide').innerHTML += `<div class="sub-container" draggable="false"><img src="${item}" alt="" draggable="false" class="sub-img" /></div>` 
      })
      document.querySelectorAll('.sub-img')[0].classList.add('sub-style')

      let prev = document.getElementById('prev')
      let next = document.getElementById('next')
      let imageIndex = 0;
      prev.setAttribute('disabled', 'disabled')
      prev.classList.add('hide')


      const setSlider = (img) => {
        next.addEventListener('click', () => {
         imageIndex++
          if (imageIndex >= img.length-1){
            next.setAttribute('disabled', 'disabled')
            next.classList.add('hide')
          }
          prev.removeAttribute('disabled')
          prev.classList.remove('hide')
          
          setImage(imageIndex)
          setSubimage(imageIndex)

          const subContainerWidth = document.querySelector('.sub-container').offsetWidth
          document.querySelector('.sub-slide').scrollLeft += subContainerWidth
          
        })
        prev.addEventListener('click', () => {
          imageIndex--
          if (imageIndex == 0) {
            prev.setAttribute('disabled', 'disabled')
            prev.classList.add('hide')
          }
          next.removeAttribute('disabled')
          next.classList.remove('hide')
          setImage(imageIndex)
          setSubimage(imageIndex)

          const subContainerWidth = document.querySelector('.sub-container').offsetWidth
          document.querySelector('.sub-slide').scrollLeft -= subContainerWidth
        })
  
        function setImage(index) {
          document.getElementById("img").src = img[index];
        };
        setImage(imageIndex);
      }
      setSlider(images)

      const setSubimage = (subIndex) => {
        //set sub style
        Array.from(document.querySelectorAll('.sub-img')).forEach((item, index) => {
          item.classList.remove('sub-style')
          if(index == subIndex){
            item.classList.add('sub-style')
          }
          
          //set main slider on sub images
          item.addEventListener('click', (e) => {
            document.querySelectorAll('.sub-img').forEach(item2 => {
              item2.classList.remove('sub-style')
              imageIndex = index
            })
            item.classList.add('sub-style')
            document.getElementById("img").src = item.getAttribute('src');
          })

        })

      }
      setSubimage(imageIndex)


      
      let isDown = false;
      let startX;
      let scrollLeft;
      const slider = document.querySelector('.sub-slide');

      const end = () => {
        isDown = false;
        slider.classList.remove('active');
      }

      const start = (e) => {
        isDown = true;
        slider.classList.add('active');
        startX = e.pageX;
        scrollLeft = slider.scrollLeft;	
      }

      const move = (e) => {
        if(!isDown) return;
        e.preventDefault();
        const x = e.pageX;
        const dist = (x - startX);
        slider.scrollLeft = scrollLeft - dist;
      }

      (() => {
        slider.addEventListener('mousedown', start);
        slider.addEventListener('mousemove', move);
        slider.addEventListener('mouseleave', end);
        slider.addEventListener('mouseup', end);
      })();

    </script>
  </body>
</html>