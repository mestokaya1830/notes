import{_ as c,a as m,o as r,c as a,b as t,t as l,i as h,w as p,v as u,e as d}from"./index-20d891a6.js";const f={name:"Index",data(){return{post:{title:"",body:"",imageName:""},data:"",message:"",error:{},file:null}},mounted(){this.getPost()},methods:{async getPost(){await m.get(`/api/admin/post/${this.$route.params.id}`).then(o=>{o.status==200&&(this.post=o.data.post)})},selectImage(o){this.file=o.target.files[0]},async updatePost(){this.data=new FormData,this.file!==null&&(this.data=new FormData,this.post.imageName=`${this.$store.state.auth._id}.${this.file.name}`,this.data.append("file",this.file)),this.data.append("post",JSON.stringify(this.post)),this.post.title==""?this.error={title:"Title cant bu null!"}:this.post.body==""?this.error={body:"Body cant be null!"}:this.post.imageName==""?this.error={file:"No selected file!"}:await m.post("/api/admin/update",this.data).then(o=>{o.status==200&&(this.error={},this.message=o.data,setTimeout(()=>{this.$router.push("/admin/post/"+this.$route.params.id)},2e3))})},getBack(){window.history.back()}}},g={class:"container"},b=t("h1",null,"Create New Post",-1),_={class:"text text-success text-center"},y={class:"mb-3 row"},x=t("label",{for:"title"},"Title",-1),v={key:0,class:"text text-danger mt-2"},w=t("label",{for:"body"},"Body",-1),k={key:0,class:"text text-danger mt-2"},N=t("label",{for:"title"},"Image",-1),B=["src"],C={class:"mt-3"},I={key:0,class:"text text-danger mt-2"},P={class:"d-grid mt-3"};function D(o,e,T,V,s,n){return r(),a("div",null,[t("div",g,[b,t("button",{class:"btn btn-secondary",onClick:e[0]||(e[0]=i=>n.getBack())},"Return"),t("h3",_,l(s.message),1),t("form",{onSubmit:e[5]||(e[5]=h(()=>{},["prevent"])),id:"form",class:"border rounded p-4"},[t("div",y,[x,t("div",null,[p(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=i=>s.post.title=i)},null,512),[[u,s.post.title]]),s.error.title?(r(),a("div",v,l(s.error.title),1)):d("",!0)]),w,t("div",null,[p(t("textarea",{class:"form-control",rows:"10","onUpdate:modelValue":e[2]||(e[2]=i=>s.post.body=i),id:"body"},null,512),[[u,s.post.body]]),s.error.body?(r(),a("div",k,l(s.error.body),1)):d("",!0)]),N,t("img",{src:`/uploads/${s.post.imageName}`,alt:"",class:"updateImage"},null,8,B),t("div",C,[t("input",{type:"file",ref:"file",onChange:e[3]||(e[3]=i=>n.selectImage(i)),accept:"image/*"},null,544),s.error.file?(r(),a("div",I,l(s.error.file),1)):d("",!0)]),t("div",P,[t("button",{class:"btn btn-dark",onClick:e[4]||(e[4]=i=>n.updatePost())},"Update")])])],32)])])}const U=c(f,[["render",D]]);export{U as default};
